---
title: "R Notebook"
output:
  pdf_document: default
  html_notebook: default
---
```{r setup, include=FALSE}
library("knitr")
library("magrittr")
library(kableExtra)
###--- Update the knitr working directory (R works from the project folder, knitr works in the rmd folder)
#dd <- getwd()
#knitr::opts_knit$set(root.dir= paste(dd,'/../../')) 
#opts_knit$set(root.dir=normalizePath('../'))
```



This is an [R Markdown](http://rmarkdown.rstudio.com) Notebook. When you execute code within the notebook, the results appear beneath the code. 

Try executing this chunk by clicking the *Run* button within the chunk or by placing your cursor inside it and pressing *Cmd+Shift+Enter*. 

```{r}
CH<-read.csv(file="STEP_1/Char_info.csv", header = T, as.is=T, check.names=F)

kable(CH[,c(1:6)],  booktabs=TRUE,
      caption = 'Initial characters obtained at Step 1. ')%>%
  kable_styling(full_width = F, font_size=8, latex_options="hold_position") %>%
  column_spec(1, bold = T) %>%
  column_spec(6, width = "10em") %>%
  footnote(c("ID - character ID in this study.",
    "IDR*- character ID in Sharkey et al. (2012)."))

```

Add a new chunk by clicking the *Insert Chunk* button on the toolbar or by pressing *Cmd+Option+I*.

When you save the notebook, an HTML file containing the code and output will be saved alongside it (click the *Preview* button or press *Cmd+Shift+K* to preview the HTML file). 

# Step 2. Incorporating anatomical dependencies: constructing amalgamations at the AD level

The pairs of anatomically depenent characters -- $C_2$, $C_3$ and $C_5$, $C_6$ have to be apropriately amalgamated into single characters to adeuqtely model the dependecies. The amalgamation produces the following (see the text in the article):

* $C_3 \oplus C_2=C_{3,2}\{00,01,10,11\}$. $C_{3,2}$  is coded in the matrix as  $C_{3,2}\{0\&1,0\&1,2,3\}$.

* $C_5$ and $C_6$ are combinded into $C_{5,6}$. The synchronous dependency between these characters has to be eliminated that gives the character $C_{5,6}$ without changing the state pattern.

The recoding of dependent characters constructs the amalgamated characters at the AD level. If a character does not display any dependencies then we treat it as correctly amalgamated at the AD level by default. The new matrix and character report of the characters amalgamated at the AD level can be found in `STEP_2/Step2_matrix.nex` and `STEP_2/Char_info_step_2.csv` respectively. Let's have a look into them.
```{r}


AN<-read.csv(file="STEP_3/Char_annotation.csv", header = T, as.is=T, check.names=F)

kable(AN, booktabs=TRUE,
      caption = 'Characters linked with HAO terms (Step 3).')%>%
  kable_styling(full_width = F, font_size=8, latex_options="hold_position")

```
adadad